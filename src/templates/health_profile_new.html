{{ template "head" . }}

{{ if .Breadcrumbs }}
<nav class="breadcrumb" aria-label="Breadcrumb">
  {{ range $i, $b := .Breadcrumbs }}
    {{ if $i }}<span class="breadcrumb-separator">&gt;</span>{{ end }}
    {{ if $b.IsCurrent }}
      <span class="breadcrumb-current">{{ $b.Name }}</span>
    {{ else }}
      <a href="{{ $b.URL }}" class="breadcrumb-item">{{ $b.Name }}</a>
    {{ end }}
  {{ end }}
</nav>
{{ end }}

{{ if .Error }}
<div class="alert alert-red">
  {{ .Error }}
</div>
{{ end }}

<div class="page-header">
  <h2>Add Health Profile</h2>
</div>

<form method="POST" action="/health/new">
  <input type="hidden" name="_csrf" value="{{ .csrf_token }}" />
  <div class="form-group">
    <label for="name" class="item-title">Name <span class="required">*</span></label>
    <input type="text" id="name" name="name" class="form-item" required
           placeholder="e.g., John Doe"
           value="{{ if .FormData }}{{ index .FormData "name" }}{{ end }}">
    <small class="muted-text">Full name of the person</small>
  </div>

  <div class="form-group">
    <label for="date_of_birth" class="item-title">Date of Birth</label>
    <input type="date" id="date_of_birth" name="date_of_birth" class="form-item"
           value="{{ if .FormData }}{{ index .FormData "date_of_birth" }}{{ end }}">
    <small class="muted-text">Used to calculate age-based reference ranges</small>
  </div>

  <div class="form-group">
    <label for="gender" class="item-title">Gender</label>
    <select id="gender" name="gender" class="form-item">
      <option value="">-- Not specified --</option>
      <option value="Male" {{ if and .FormData (eq (index .FormData "gender") "Male") }}selected{{ end }}>Male</option>
      <option value="Female" {{ if and .FormData (eq (index .FormData "gender") "Female") }}selected{{ end }}>Female</option>
    </select>
    <small class="muted-text">Used for gender-based reference ranges</small>
  </div>

  <div class="form-group">
    <label for="description" class="item-title">Description</label>
    <textarea id="description" name="description" class="form-item" rows="3">{{ if .FormData }}{{ index .FormData "description" }}{{ end }}</textarea>
    <small class="muted-text">Optional notes about health baseline, included in AI analysis context</small>
  </div>

  <div class="form-group">
    <button type="submit" class="btn">Create Profile</button>
    <a href="/health" class="btn">Cancel</a>
  </div>
</form>

{{ template "foot" . }}
