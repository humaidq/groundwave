{{ template "head" . }}

{{ if .Breadcrumbs }}
<nav class="breadcrumb" aria-label="Breadcrumb">
  {{ range $i, $b := .Breadcrumbs }}
    {{ if $i }}<span class="breadcrumb-separator">&gt;</span>{{ end }}
    {{ if $b.IsCurrent }}
      <span class="breadcrumb-current">{{ $b.Name }}</span>
    {{ else }}
      <a href="{{ $b.URL }}" class="breadcrumb-item">{{ $b.Name }}</a>
    {{ end }}
  {{ end }}
</nav>
{{ end }}

<div class="page-header">
  <h2>Service Contacts</h2>
  <div class="page-header-actions">
    <a href="/contacts" class="btn">Back to Contacts</a>
    <a href="/contact/new?is_service=true" class="btn">+ Add Service Contact</a>
  </div>
</div>

{{ if .Error }}
<div class="alert alert-red">
  <h5 class="alert-title">Error</h5>
  <p>{{.Error}}</p>
</div>
{{end}}

<div class="tag-filter-section">
  <form method="GET" action="/service-contacts" class="tag-filter-form">
    <input type="text" name="q" placeholder="Search" value="{{ .SearchQuery }}" class="form-item">
  </form>

  <details class="search-syntax-help muted-text">
    <summary class="search-syntax-toggle">
      <i class="fa-solid fa-circle-question" aria-hidden="true"></i>
      <span>Search syntax</span>
    </summary>
    <p class="search-syntax-examples">
      <span>Try:</span>
      <code>tag:university support</code>,
      <code>has:phone</code>,
      <code>-has:email</code>
    </p>
  </details>
</div>

{{ if .ServiceContacts }}
<div class="list-card-list" id="serviceList">
  {{ range .ServiceContacts }}
    <div class="list-card" data-org="{{ if .Organization }}{{ .Organization }}{{ end }}" data-name="{{ .NameDisplay }}">
      <a href="/contact/{{ .ID }}" class="list-card-link list-card-entry-link">
        <div class="list-card-entry">
          <span class="list-card-leading">
            <span class="list-card-icon" aria-hidden="true"><i class="fa-solid fa-building"></i></span>
          </span>
          <div class="list-card-entry-body">
            <div class="list-card-title">
              {{ if .Organization }}
                <strong>{{ .Organization }}</strong> — {{ .NameDisplay }}{{ if .Title }} ({{ .Title }}){{ end }}
              {{ else }}
                {{ .NameDisplay }}{{ if .Title }} - {{ .Title }}{{ end }}
              {{ end }}
            </div>
            <div class="list-card-meta">
              {{ if or .PrimaryPhone .PrimaryEmail }}
              <span class="muted-text">
                {{ if .PrimaryPhone }}{{ .PrimaryPhone }}{{ end }}
                {{ if and .PrimaryPhone .PrimaryEmail }} • {{ end }}
                {{ if .PrimaryEmail }}{{ .PrimaryEmail }}{{ end }}
              </span>
              {{ end }}
              {{ if .Tags }}
              <div class="tag-badges">
                {{ range .Tags }}
                <a href="/service-contacts?q=tag:{{ .Name | urlquery }}" class="tag-badge"
                   onclick="event.stopPropagation(); event.preventDefault(); window.location.href='/service-contacts?q=tag:{{ .Name | urlquery }}';">
                  {{ .Name }}
                </a>
                {{ end }}
              </div>
              {{ end }}
            </div>
          </div>
        </div>
      </a>
    </div>
  {{ end }}
</div>
{{ else }}
<p class="muted-text">No service contacts found. <a href="/contact/new?is_service=true">Add your first service contact</a>.</p>
{{ end }}

{{ template "foot" . }}
